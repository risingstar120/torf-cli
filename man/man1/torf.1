.TH torf 1 "June 11, 2018" "USER COMMANDS"
.SH NAME
torf \- Command line tool to create, display and edit torrents
.SH SYNOPSIS
.B torf
[\fIPATH\fP]
[\fIOPTIONS\fP]
.SH DESCRIPTION
torf can create new torrents, display information about existing torrents, and
edit torrents (e.g. to remove a comment or change the tracker) without
re\-hashing the content.
.PP
.TS
tab (|);
r lx.
Create|T{
.B torf
.I PATH
[\fIOPTIONS\fP]
[\fB\-o\fP \fITORRENT\fP]
T}
Display|T{
.B torf
\fB-i\fP \fITORRENT\fP
T}
Edit|T{
.B torf
\fB-i\fP \fITORRENT\fP
[\fIOPTIONS\fP]
\fB-o\fP \fITORRENT\fP
T}
.TE
.SH OPTIONS
Options starting with
.B \-\-no
take precedence.
.PP
.I PATH
.RS
The path to the torrent's content.
.RE
.PP
.BR \-\-exclude ,
.B \-e
.I EXCLUDE
.RS
Exclude files from
.I PATH
that match the pattern
.IR EXCLUDE .
This option may be given multiple times.  It is ignored if
.I PATH
is not a directory.  See
.BR EXCLUDING\ FILES .
.RE
.PP
.RE
.BR \-\-in ,
.B \-i
.I TORRENT
.RS
Read metainfo from
.IR TORRENT .
.RE
.PP
.BR \-\-out ,
.B \-o
.I TORRENT
.RS
Write torrent metadata to
.IR TORRENT .
.BR
Default:
.IR NAME \fB.torrent
.RE
.PP
.BR \-\-magnet ,
.B \-m
.RS
Create magnet link.
.RE
.PP
.BR \-\-name ,
.B \-n
.I NAME
.RS
The name of the destination file or directory when the torrent is downloaded.
.BR
Default: Basename of
.I PATH
.RE
.PP
.BR \-\-tracker ,
.B \-t
.I TRACKER
.RS
The announce URL of a tracker.  This option may be given multiple times.
.RE
.PP
.BR \-\-notracker ,
.B \-T
.RS
Don't use any trackers.
.RE
.PP
.BR \-\-webseed ,
.B \-w
.I WEBSEED
.RS
A webseed URL (BEP19).  This option may be given multiple times.
.RE
.PP
.BR \-\-nowebseed ,
.B \-W
.RS
Don't use any webseeds.
.RE
.PP
.BR \-\-private ,
.B \-p
.RS
Tell clients to use tracker(s) exclusively for peer discovery.
.RE
.PP
.BR \-\-noprivate ,
.B \-P
.RS
Allow clients to use DHT and PEX for peer discovery.
.RE
.PP
.BR \-\-comment ,
.B \-c
.I COMMENT
.RS
A comment that is stored in the torrent file.
.RE
.PP
.BR \-\-nocomment ,
.B \-C
.RS
Remove the comment.
.RE
.PP
.BR \-\-date ,
.B \-d
.I DATE
.RS
The creation date as
.IR YYYY\-MM\-DD[\ HH:MM[:SS]] ,
\*(lqnow\*(rq for local time or \*(lqtoday\*(rq for local time at midnight.
.BR
Default: \*(lqtoday\*(rq
.RE
.PP
.BR \-\-nodate ,
.B \-D
.RS
Remove the creation date.
.RE
.PP
.BR \-\-xseed ,
.B \-x
.RS
Randomize the info hash to help with cross\-seeding.  This simply adds an
\*(lqentropy\*(rq field to the \*(lqinfo\*(rq section of the metainfo and sets
it to a random integer.
.RE
.PP
.BR \-\-noxseed ,
.B \-X
.RS
De\-randomize a previously randomized info hash of an existing torrent.  This
removes the \*(lqentropy\*(rq field from the \*(lqinfo\*(rq section of the
metainfo.
.RE
.PP
.BR \-\-nocreator ,
.B \-R
.RS
Don't store the name and version of this application in the generated torrent.
.RE
.PP
.BR \-\-yes ,
.B \-y
.RS
Answer all yes/no prompts with \*(lqyes\*(rq.  At the moment, all this does is
overwrite
.I TORRENT
without asking.
.RE
.PP
.BR \-\-config ,
.B \-f
.I FILE
.RS
Read command line arguments from configuration FILE.  See
.BR CONFIGURATION\ FILE .
.BR
Default:
.IR $XDG_CONFIG_HOME \fB/torf/config\fP
where
.B $XDG_CONFIG_HOME
defaults to
.IR $HOME \fB/.config\fP.
.RE
.PP
.BR \-\-noconfig ,
.B \-F
.RS
Do not use any configuration file.
.RE
.PP
.BR \-\-profile ,
.B \-z
.I PROFILE
.RS
Use predefined arguments specified in PROFILE.  This option may be given
multiple times.  See
.BR CONFIGURATION\ FILE .
.RE
.PP
.BR \-\-human ,
.B \-u
.RS
Display information in human-readable output even if STDOUT is not a TTY.  See
.BR PIPING\ OUTPUT .
.RE
.PP
.BR \-\-nohuman ,
.B \-U
.RS
Display information in machine-readable output even if STDOUT is a TTY.  See
.BR PIPING\ OUTPUT .
.RE
.PP
.BR \-\-help ,
.B \-h
.RS
Display a short help text.
.RE
.PP
.BR \-\-version
.RS
Display the version number.
.RE
.SH EXAMPLES
Create \*(lqfoo.torrent\*(rq with two trackers and don't store the creation
date:
.PP
.in +4n
\fBtorf path/to/foo \\
     \-t http://example.org:6881/announce \\
     \-t http://example.com:6881/announce \\
     \-\-nodate\fP
.PP
Read \*(lqfoo.torrent\*(rq and print its metainfo:
.PP
.in +4n
.B torf \-i foo.torrent
.PP
Print only the name:
.PP
.in +4n
.B torf \-i foo.torrent | grep '^Name' | cut -f2
.PP
Change the comment and remove the date from \*(lqfoo.torrent\*(rq, write the
result to \*(lqbar.torrent\*(rq:
.PP
.in +4n
.B torf \-i foo.torrent \-c 'New comment' \-D \-o bar.torrent
.SH EXCLUDING FILES
The
.B \-\-exclude
option takes a pattern that is matched against file names in
.IR PATH .
Any matching files are not included in the torrent.  Empty directories are not
included because the torrent file format only knows files.

Patterns use these special characters:
.PP
.in +4n
.nf
     \fB*\fP  matches everything
     \fB?\fP  matches any single character
 \fB[\fP\fISEQ\fP\fB]\fP  matches any character in \fISEQ\fP
\fB[!\fP\fISEQ\fP\fB]\fP  matches any character not in \fISEQ\fP
.SH CONFIGURATION FILE
Configuration files list command line options with all leading \*(lq-\*(rq
characters removed.  If an option takes a parameter, \*(lq=\*(rq is used as a
separator.  Spaces before and after the \*(lq=\*(rq are ignored.  The parameter
may be quoted with single or double quotes to preserve leading and/or trailing
spaces.  Comments start with \*(lq#\*(rq.  Any of the options listed in the
.B OPTIONS
section are allowed except for
.BR config ,
.BR noconfig ,
.BR profile ,
.B help
and
.BR version .
.SS Profiles
A profile is a set of options bound to a name that is given to the
.B --profile
option.  In the configuration file it is specified as
.RI \*(lq[ PROFILE\ NAME ]\*(rq
followed by a list of options.  Profiles inherit any options specified globally
at the top of the file, but they can overload them.
.SS Example
This is an example configuration file with some global custom defaults and the
two profiles \*(lqfoo\*(rq and \*(lqbar\*(rq:
.RS
.PP
.EX
yes
nodate
exclude = *.txt

[foo]
tracker = https://foo1
tracker = https://foo2
private

[bar]
tracker = https://bar
.EE
.RE
.PP
With this configuration file, the arguments
.PP
.RS
.EX
--yes
--nodate
--exclude '*.txt'
.EE
.RE
.PP
are always used,
.B --profile\ foo
expands to
.PP
.RS
.EX
--yes
--nodate
--exclude '*.txt'
--tracker https://foo1 --tracker https://foo2
--private
.EE
.RE
.PP
and
.B --profile\ bar
expands to
.PP
.RS
.EX
--yes
--nodate
--exclude '*.txt'
--tracker https://bar
.EE
.RE
.SH PIPING OUTPUT
If stdout is not a TTY (i.e. when output is piped) or if the
.B \-\-nohuman
option is provided, the output format is slightly different:
.IP \(bu 2
Leading spaces are removed from each line.
.IP \(bu 2
The delimiter between label and value as well as between multiple values (files,
trackers, etc) is a tab character (\\t; ASCII 0x9).
.IP \(bu 2
Numbers are not scaled (e.g. \*(lq1024\*(rq instead of \*(lq1 KiB\*(rq).
.SH EXIT STATUS
torf returns zero on success and non-zero on failure.  You can lookup error
codes in the output of
.BR errno\ \-l .
.PP
.SH REPORTING BUGS
Bug reports, feature requests and poems about hedgehogs are welcome on the
.UR https\://github.com/rndusr/torf\-cli/issues
issue tracker
.UE .
